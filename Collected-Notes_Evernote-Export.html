<html>
<head>
  <title>Evernote Export</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/304720 (en-US, DDL); Windows/10.0.17134 (Win64);"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="606"/>
<h1>Simple Secure Form</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>Created:</b></td><td><i>05-Oct-16 18:18</i></td></tr>
<tr><td><b>Updated:</b></td><td><i>26-Dec-16 19:19</i></td></tr>
<tr><td><b>Author:</b></td><td><i>Amine AL KADERI</i></td></tr>
<tr><td><b>Source:</b></td><td><a href="https://blog.mailchimp.com/is-your-own-domain-name-getting-you-blocked/"><i>https://blog.mailchimp.com/is-your-own-domain-name-getting-you-blocked/</i></a></td></tr>
</table>
</div>
<br/>

<div>
<span><div><strong><br clear="none"/></strong></div><ul><li><strong><a href="https://www.owasp.org/index.php/PHP_Security_Cheat_Sheet" shape="rect" target="_blank">https://www.owasp.org/index.php/PHP_Security_Cheat_Sheet</a></strong></li><li><strong><a href="http://stackoverflow.com/a/1668129/3208373" shape="rect" target="_blank">http://stackoverflow.com/a/1668129/3208373</a>  </strong><ul><li><strong><a href="https://paragonie.com/blog/2015/04/secure-authentication-php-with-long-term-persistence" shape="rect" target="_blank">http://stackoverflow.com/a/1668129/3208373https://paragonie.com/blog/2015/04/secure-authentication-php-with-long-term-persistence</a> <br clear="none"/><br clear="none"/></strong></li></ul></li><li><a href="https://github.com/samyk/poisontap" shape="rect" target="_blank">https://github.com/samyk/poisontap</a></li><li><a href="http://bad-behavior.ioerror.us/" shape="rect" target="_blank">http://bad-behavior.ioerror.us/</a></li><li>Use HTTPS exclusively, at the very least for authentication and authenticated content<ul><li>Honestly, you should use HTTPS exclusively and always redirect HTTP content to HTTPS, preventing a user being tricked into providing credentials or other PII over HTTP</li></ul></li><li>Ensure Secure flag is enabled on cookies, preventing HTTPS cookies from leaking over HTTP</li><li>When using remote Javascript resources, use the <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity" shape="rect" target="_blank">Subresource Integrity</a> script tag attribute</li><li>Use <a href="https://www.wikiwand.com/en/HTTP_Strict_Transport_Security" shape="rect" target="_blank">HSTS</a> to prevent HTTPS downgrade attacks<br clear="none"/><br clear="none"/></li><li><strong>General settings checks</strong><ul><li>Force HTTPS<ul><li><span style="color: #0000ff;"><span style="text-decoration: underline;">HttpOnly [session] cookie flag:</span></span> If at all possible, make sure the session cookie has the secure and HTTP Only flags set when sent to the browser. The httponly flag provides some protection against the cookie being read by a XSS attack. The secure flag ensures that the cookie is only sent back via HTTPS, and therefore protects against network sniffing attacks. The value of the cookie should not be predictable. Where a cookie referencing a non-existent session is presented, its value should be replaced immediately to prevent <a href="https://www.owasp.org/index.php/Session_fixation" shape="rect" target="_blank">session fixation</a>.</li></ul></li><li>Prevent overload</li><li>Check weither the owner/user is authenticated (form shown only to unauthenticated visitors)<ul><li><a href="https://developer.wordpress.com/docs/oauth2/" shape="rect" target="_blank">https://developer.wordpress.com/docs/oauth2/</a></li></ul></li><li>Check Javascript is enabled. Fallback mode.</li><li>Put Key (=nonce) in <strong>session variable</strong> VS <strong>Cookie</strong> VS <strong>DB on server</strong><br clear="none"/> -&gt; <em>Do not rely on sessions or cookies, those trust the client and you should NEVER trust the client. I made a class that takes care of brute force attack protection in PHP.</em><br clear="none"/> Create a nonce using something like this: <strong><span style="font-family: 'courier new', courier, monospace;">$nonce = hash(&quot;sha256&quot;, uniqid(PRETTY_LONG_SALT, true));</span></strong>. Store this nonce in the <span style="color: #ff0000;">session</span> (not a <span style="color: #ff0000;">cookie</span>), and send it to the form of the user. Also (if necessary) secure transportation using HTTPS.<br clear="none"/> = Generate (and track, with timeout) a unique random key for every single HTML FORM you send down to the client:<br clear="none"/><span style="color: #ff4635; font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, sans-serif; font-size: 13px;"><code style="margin: 0px; padding: 1px 5px; border: 0px; font-size: 13px; font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, sans-serif; background-color: #eff0f1; white-space: normal; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">&lt;input id=&quot;fkey&quot; name=&quot;fkey&quot; type=&quot;hidden&quot; value=&quot;df8652852f139&quot; /&gt;</code></span></li><li><span style="font-family: verdana, helvetica, sans-serif;"><code>&quot;Do you think HMAC, nonce, etc are for pre-HTTPS era only?&quot; - <a href="https://security.stackexchange.com/questions/44811/is-https-and-basic-authentication-secure-enough-for-banking-webservices-restful#comment71837_44819" shape="rect">https://security.stackexchange.com/questions/44811/is-https-and-basic-authentication-secure-enough-for-banking-webservices-restful#comment71837_44819</a> </code></span></li></ul></li><li><strong>Securly use Ajax and have a good fallback mode in case JS is disabled by the client.</strong><ul><li>Inspiration<ul><li><a href="http://tutorialzine.com/2013/08/simple-registration-system-php-mysql/" shape="rect" target="_blank">http://tutorialzine.com/2013/08/simple-registration-system-php-mysql/</a></li><li><a href="https://bootstrapious.com/p/how-to-build-a-working-bootstrap-contact-form?utm_source=sendy&amp;utm_medium=email&amp;utm_campaign=drip2" shape="rect" target="_blank">https://bootstrapious.com/p/how-to-build-a-working-bootstrap-contact-form?utm_source=sendy&amp;utm_medium=email&amp;utm_campaign=drip2</a></li></ul></li></ul></li><li><strong>Fetch logs / cached data first</strong></li><li><strong>Maximize query per IP address / Subscription throttling</strong><ul><li>Failed attempt #n = 2^n sec delay</li><li>Use of proxies or dinamic IP. Consider adding a captcha if they send too many requests (not blocking).</li><li><span style="color: #333333; font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif; font-size: 14px;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><strong>Logging the number of failed logins, system-wide</strong>, and using a running average of your site's bad-login frequency as the basis for an upper limit that you then impose on all users.</span></span></span></li><li><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="color: #333333;">The delay is not a delay before returning the response to the browser. It is more like a timeout or refractory period during which login attempts to a specific account or from a specific IP address will not be accepted or evaluated at all. That is, correct credentials will not return in a successful login, and incorrect credentials will not trigger a delay increase.</span></span></li><li><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="color: #333333;">Always allow persistent (cookie) logins (and/or a CAPTCHA-verified login form) to pass through.</span></span></li><li><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="color: #333333;">If a user tries to log in (ie. posts login credentials to the server) they will not be checked and an error is returned. A server-synchronized countdown clock should be displayed next to the login form to inform the user of the throttling. The form itself or the submit button should be disabled until the countdown is done.</span></span></li></ul></li><li><strong>Signup source</strong><ul><li><strong>MailChimp:</strong> &quot;if you only use embedded forms or the <strong>API</strong> to add subscribers to your list, you can safely guess that a signup from the hosted form is fake.&quot;</li></ul></li><li><strong>HTTP REFERRER</strong><ul><li>Trigger action only if ≠ real URL</li></ul></li><li><strong>User Agent</strong><ul><li>Trigger action only if UA seems fishy</li></ul></li><li><strong>IP Address</strong><ul><li><em>Blocklists</em><ol><li><em>Spamhaus ZEN</em></li><li><em>Barracuda BRBL</em></li><li><em>SpamCop SCBL</em></li><li><em>URIBL IP</em></li><li><em>HoneyPot HTTP:BL</em><ul><li><em>BackUp (if number of requests are limited/exceeded, or if it's overall performance-friendly: </em><a href="https://github.com/thasmo/php.honeypot-blacklist" shape="rect" target="_blank">https://github.com/thasmo/php.honeypot-blacklist)</a></li></ul></li></ol></li></ul></li><li><strong style="font-family: gotham, helvetica, arial, sans-serif; font-size: 14px;">Hidden Form Fields</strong><ul><li>When these forms are submitted, the content will be discarded while still returning a 200 response</li><li>+&quot;whitelist&quot; of acceptable post names: <a href="https://gist.github.com/amindeed/83b952364d08f2e1089d37df601f2612" shape="rect" target="_blank">https://gist.github.com/amindeed/83b952364d08f2e1089d37df601f2612</a></li></ul></li><li><strong>HoneyPot QuickLink: </strong><a href="https://www.projecthoneypot.org/manage_quicklink.php" shape="rect" target="_blank">https://www.projecthoneypot.org/manage_quicklink.php</a></li><li><strong>XRSF / CSRF</strong><ul style="font-family: gotham, helvetica, arial, sans-serif; font-size: 14px;"><li><em><strong>Libraries / Open Source Tools</strong></em><ul><li><em>https://github.com/Ocramius/PSR7Csrf</em></li><li><em>https://github.com/paragonie/anti-csrf</em></li><li><em>https://github.com/mebjas/CSRF-Protector-PHP</em></li><li><em>https://github.com/ezyang/csrf-magic</em></li><li><em>https://github.com/XCMer/csrfprotect</em></li></ul></li><li><em><strong>SESSION ID</strong></em><ul><li><em>Unique, Generated &quot;randomlly enough&quot;</em></li><li><em>Whether it has already been generated</em><ul><li><em>If yes, whether it has been used for a valid subscription operation</em></li></ul></li></ul></li><li><em><strong>NONCE</strong></em><ul><li><em>Checks to see if the token exists in both required places and that they match</em></li><li><em>Unique, Generated &quot;randomlly enough&quot;</em></li><li><em>Whether it has already been generated</em><ul><li><em>If yes, whether it has been used for a valid subscription operation</em></li></ul></li><li><em>Sample Code:</em></li></ul></li></ul></li></ul><ul style="font-family: gotham, helvetica, arial, sans-serif; font-size: 14px;"><li style="display: inline; list-style: none;"><ul><li style="display: inline; list-style: none;"><ul><li style="display: inline; list-style: none;"><ul><li style="font-weight: normal;"><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">Generating Nonce:<br clear="none"/></span></span></span><div style="margin: 0px 0px 1em; padding: 5px; border: 0px; width: auto; max-height: 600px; overflow: auto; background-color: #eff0f1; display: block; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: #393318;"><code style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, sans-serif; background-color: #eff0f1;"><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">$factory </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">=</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;"> </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #101094;">new</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;"> </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #2b91af;">RandomLib</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">\Factory</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">;</span></code></span> <span style="font-size: 12px;"><span style="font-family: 'courier new', courier, monospace;">// <a href="https://github.com/paragonie/random_compat" shape="rect" target="_blank">https://github.com/paragonie/random_compat</a></span></span><span style="color: #393318;"><code style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, sans-serif; background-color: #eff0f1;"><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;"><br clear="none"/> $generator </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">=</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;"> $factory</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">-&gt;</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">getMediumStrengthGenerator</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">();</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;"><br clear="none"/> $_SESSION</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">[</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #7d2727;">'nonce'</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">]</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;"> </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">[]</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;"> </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">=</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;"> $generator</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">-&gt;</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">generate</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">(</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #7d2727;">32</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">);</span></code></span></div></li><li style="font-weight: normal;"><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">Validating Nonce:<br clear="none"/></span></span></span><div style="margin: 0px 0px 1em; padding: 5px; border: 0px; font-size: 13px; width: auto; max-height: 600px; overflow: auto; font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, sans-serif; background-color: #eff0f1; display: block; color: #393318; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><code style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, sans-serif; background-color: #eff0f1;"><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">$found </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">=</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;"> array_search</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">(</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">$nonce</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">,</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;"> $_SESSION</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">[</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #7d2727;">'nonces'</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">]);</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #101094;">if</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;"> </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">(!</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">$found</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">)</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;"> </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">{</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;"><br clear="none"/>    </span> <span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #101094;">throw</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;"> </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #101094;">new</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;"> </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #2b91af;">Exception</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">(</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #7d2727;">&quot;Nonce not found! Handle this or the app crashes&quot;</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">);</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">}</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #858c93;">// Yay, now delete it.</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;"><br clear="none"/> unset</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">(</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">$_SESSION</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">[</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #7d2727;">'nonce'</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">][</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">$found</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; color: #303336;">]);</span></code></div></li></ul></li></ul></li></ul></li></ul><ul><li style="display: inline; list-style: none;"><ul><li style="display: inline; list-style: none;"><ul><li style="display: inline; list-style: none;"><ul><li style="font-weight: normal;"><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">HTML Form Begining (MailChimp's Example):<br clear="none"/></span></span></span><div style="margin: 0px 0px 1em; padding: 5px; border: 0px; width: auto; max-height: 600px; overflow: auto; background-color: #eff0f1; display: block; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: #393318;"><span style="font-size: 13px;"><span style="font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, sans-serif;">&lt;form action=&quot;https://jsplumbtoolkit.us2.list-manage.com/subscribe/post&quot; method=&quot;POST&quot;&gt;<br clear="none"/></span></span></span><span style="font-size: 13px; font-family: gotham, helvetica, arial, sans-serif;"><span style="font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, sans-serif;"><span style="color: #393318;">&lt;input type=&quot;hidden&quot; name=&quot;u&quot; value=&quot;dd538c1f8f70af0f1471357bc&quot;&gt;<br clear="none"/></span></span></span> <span style="font-size: 13px; font-family: gotham, helvetica, arial, sans-serif;"><span style="font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, sans-serif;"><span style="color: #393318;">&lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;484358390d&quot;&gt;</span></span></span></div></li></ul></li></ul></li></ul></li></ul><ul style="font-family: gotham, helvetica, arial, sans-serif; font-size: 14px;"><li style="display: inline; list-style: none;"><ul><li style="display: inline; list-style: none;"><ul><li style="display: inline; list-style: none;"><ul><li style="font-weight: normal;"><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">HTML Form Hidden Fields (MailChimp's Example):<br clear="none"/></span></span></span><div style="margin: 0px 0px 1em; padding: 5px; border: 0px; width: auto; max-height: 600px; overflow: auto; background-color: #eff0f1; display: block; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: #393318;"><span style="font-size: 13px;"><span style="font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, sans-serif;">&lt;!-- people should not fill these in and expect good things --&gt;<br clear="none"/> &lt;div class=&quot;field-shift&quot; aria-label=&quot;Please leave the following three fields empty&quot;&gt;<br clear="none"/> &lt;label for=&quot;b_name&quot;&gt;Name: &lt;/label&gt;<br clear="none"/>    &lt;input type=&quot;text&quot; name=&quot;b_name&quot; tabindex=&quot;-1&quot; value=&quot;&quot; placeholder=&quot;Freddie&quot; id=&quot;b_name&quot;&gt;<br clear="none"/> &lt;label for=&quot;b_email&quot;&gt;Email: &lt;/label&gt;<br clear="none"/>    &lt;input type=&quot;email&quot; name=&quot;b_email&quot; tabindex=&quot;-1&quot; value=&quot;&quot; placeholder=&quot;youremail@gmail.com&quot; id=&quot;b_email&quot;&gt; &lt;label for=&quot;b_comment&quot;&gt;Comment: &lt;/label&gt;<br clear="none"/>    &lt;textarea name=&quot;b_comment&quot; tabindex=&quot;-1&quot; placeholder=&quot;Please comment&quot; id=&quot;b_comment&quot;&gt;&lt;/textarea&gt;<br clear="none"/> &lt;/div&gt;</span></span></span></div></li></ul></li></ul></li></ul></li></ul><ul><li><strong>On submit: Count as try #n (checking against the DB)</strong><ul><li>The consensus was that you can make an SQL table of failed attempts along with timestamps for each one. Then you would query that on a failed login and check the number of attempts and timestamps using cookies or querying every time.</li><li>Adding two fields to your user table, '<strong>first_failed_login</strong>' [<strong>INTEGER unix timestamp</strong> or <strong>DATETIME</strong>] and '<strong>failed_login_count</strong>'. [<strong>INTEGER</strong>]. This will make your login system recognize only 3 login attempts per user every 10 minutes. Code: <a href="https://gist.github.com/amindeed/d0fc81e552be64ff5685145ebc15e028" shape="rect" target="_blank">https://gist.github.com/amindeed/d0fc81e552be64ff5685145ebc15e028</a> </li><li>For Brute Forcing: <a href="https://github.com/ejfrancis/brute-force-block#usage" shape="rect" target="_blank">https://github.com/ejfrancis/brute-force-block#usage</a></li><li>Optionally use CAPTCHA (for example, attempts 1-2 are normal, attempts 3-5 are CAPTCHA'd, further attempts blocked for 15 minutes).</li><li>Count failed attempts against username</li></ul></li><li><strong>Typed email address</strong><ul><li><strong style="text-rendering: optimizeLegibility; font-weight: bolder; font-style: normal; color: #333333; font-family: 'Fira Sans', 'Source Sans Pro', Helvetica, Arial, sans-serif; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #e6e6e6;"><code style="font-style: normal; font-variant: normal; font-weight: bold; font-stretch: normal; font-size: 0.875rem; font-family: 'Fira Mono', 'Source Code Pro', monospace; word-wrap: break-word;">FILTER_VALIDATE_EMAIL</code></strong></li><li><em><a href="https://github.com/hbattat/verifyEmail" shape="rect" target="_blank">https://github.com/hbattat/verifyEmail</a></em></li><li><em><a href="https://secure.php.net/manual/en/function.getmxrr.php#103123" shape="rect" target="_blank">https://secure.php.net/manual/en/function.getmxrr.php#103123</a></em></li><li><em>Check if domain name is blacklisted/dead</em><ol><li><em>Spamhaus DBL</em></li><li><em>URIBL Domains</em></li></ol></li><li><em>Check if domain has valid MX records</em></li><li><em>Check if it's a <strong>role-based</strong>, <strong>malformed</strong> or <strong>inexisting [user/alias]</strong> email address + common spam trap names (junk@, test@, asdf@, spam@, etc.)</em></li></ul></li><li><strong>&quot;<span style="color: #ff0000;"><em>N</em></span> [failed] requests within a time span <span style="color: #ff0000;">(<em>t<span style="font-size: 14px;"><sub>1</sub>-t<sub><span style="font-size: 14px;">0</span></sub>)&lt;T</span></em><sub><span style="font-size: 14px;"><em>min</em></span></sub></span> [, which at least has 75% of related information</strong> <span style="font-family: gotham, helvetica, arial, sans-serif; font-size: 14px;"><strong>similar to previous requests</strong></span><strong>]&quot;.<br clear="none"/> Recent entries on the top of the list/log. Break once</strong> <strong>data matched.<br clear="none"/> For that, the followings should be checked at every request:</strong><ul><li>IP address</li><li>HTTP REFERRER</li><li>User Agent</li><li>Session ID</li><li>Subscription email address</li><li>Nonce</li><li><em>{last time visit}</em></li><li><em>{number of attempts}</em></li></ul></li><li><strong>Logging</strong><ul><li>Log/send fake subscriptions notices: <a href="https://gist.github.com/amindeed/732f27592a07d6ecb9e02a1547a2b4aa" shape="rect" target="_blank">https://gist.github.com/amindeed/732f27592a07d6ecb9e02a1547a2b4aa</a></li><li>Log to file <span style="text-decoration: underline;"><strong>vs</strong></span> DB <span style="text-decoration: underline;"><strong>vs</strong></span> email</li><li><br clear="none"/></li></ul></li><li><strong><br clear="none"/></strong></li><li><strong>Email confirmation</strong><ul><li>Log: <em>opt-in IP <strong><span style="text-decoration: underline;">VS</span></strong> confirmation IP</em></li></ul></li></ul><div><strong><br clear="none"/></strong></div><div><strong><br clear="none"/></strong></div><ul><li><strong>Thanking already registred users for passing by again <em>(check email address, cookies)</em></strong></li><li><strong>CAPTCHA</strong></li><li><strong>Block (blank page to reduce traffic)</strong></li><li><strong>Email Templates</strong><ul><li>     <a href="https://github.com/seanpowell/Email-Boilerplate" shape="rect" target="_blank">https://github.com/seanpowell/Email-Boilerplate</a></li></ul></li><li><strong>Tools to be used</strong><ul><li><a href="https://t4t5.github.io/sweetalert/" shape="rect" target="_blank">https://t4t5.github.io/sweetalert/</a> </li></ul></li></ul><div><strong><br clear="none"/></strong></div><hr/><div><strong><br clear="none"/></strong></div><ul><li><span style="color: #c0c0c0;"><strong>The signup source is Hosted Signup Form. </strong><br clear="none"/> Due to the way spambots submit fake data, MailChimp notes their signup source as Hosted Signup Form in list data. Although this can be a legitimate source, if you only use embedded forms or the API to add subscribers to your list, you can safely guess that a signup from the hosted form is fake.<br clear="none"/></span><br clear="none"/></li><li><span style="color: #c0c0c0;"><strong>The opt-in and confirmation IP addresses are different. </strong><br clear="none"/> When someone signs up to a list, they generally submit their information and confirm their subscription from the same computer, which has one IP address. When a spambot signs up to your list, often one computer with one IP address will sign up to the list, while a different computer with a different IP address will confirm the subscription. If the IP addresses for opt-in and confirmation are different, then it could be a spam signup. <a href="http://kb.mailchimp.com/lists/managing-subscribers/view-or-export-a-list" shape="rect" target="_blank"><span style="color: #c0c0c0;">Export your list</span></a> to compare the opt-in and confirmation IP addresses. (<a href="http://kb.mailchimp.com/lists/signup-forms/about-fake-signups" shape="rect" target="_blank"><span style="color: #c0c0c0;">http://kb.mailchimp.com/lists/signup-forms/about-fake-signups</span></a>)</span></li></ul><div><br clear="none"/></div><div><h2><span style="color: #339966;">The CAN-SPAM Act of 2003</span></h2></div><div><ul><li><span style="color: #339966;">Never use deceptive headers, from-names, reply-tos, or subject lines.</span></li><li><span style="color: #339966;">You must always provide an unsubscribe link.</span></li><li><span style="color: #339966;">Remove recipients from your list within 10 business days.</span></li><li><span style="color: #339966;">The unsubscribe link must work for at least 30 days after sending.</span></li><li><span style="color: #339966;">You must include your physical mailing address in the email (PO Boxes are sufficient).</span></li></ul><div><br clear="none"/></div></div><div><h2><span style="color: #339966;">Permission Reminders: (“You’re receiving this email because…”)</span></h2></div><div><h3><span style="color: #339966;">How can I keep my list free of spam traps?</span></h3></div><ul><li><a href="http://kb.mailchimp.com/article/how-can-i-remove-someone-from-my-list-who-has-never-opened-a-campaign" shape="rect" target="_blank"><span style="color: #339966;">give your list a good pruning by removing old, disengaged subscribers</span></a></li><li><a href="http://kb.mailchimp.com/article/does-mailchimp-automatically-clean-my-bounces-and-unsubscribes" shape="rect" target="_blank"><span style="color: #339966;">automatically clean bounced emails from your list</span></a></li><li><a href="http://kb.mailchimp.com/article/how-does-confirmed-optin-or-double-optin-work" shape="rect" target="_blank"><span style="color: #339966;">using double opt-in confirmation for list signup</span></a></li><li><span style="color: #339966;"><strong>Engagement-Based Sunsetting</strong>: Remove email address from your mailing list if they do not open or click a message in some period of time. This time period varies depending on factors like your industry and sending frequency.</span></li><li><strong><span style="color: #339966;">Be very, very careful about which companies you pick for co-registration or email append services.<br clear="none"/></span></strong> <span style="color: #339966;">Co-registration is when you sort of piggy back on another company’s opt-in form. Typically, the prospective subscriber fills out your co-registration partner’s form, and then checks a box bear the bottom of the form that says they also want to opt into your list.<br clear="none"/></span><span style="color: #339966;">This technique used to work very well, but it’s always been a bit borderline spammy, and it’s never resulted in high-quality lists. Now that we have CASL, co-registration forms also cannot be pre-checked, so if your co-reg partner is still using pre-checked boxes (i.e., pre-checking the boxes so people are opting into your list by default), either get them to uncheck that box, or stop doing business with them. (More: </span><a href="http://j.mp/2dLfrgz" shape="rect" target="_blank">http://j.mp/2dLfrgz</a>)</li><li><span style="color: #339966;">Check regularly if you have not been flagegd as &quot;backscatterer&quot; !</span></li></ul><div><br clear="none"/></div><div><span style="color: #c0c0c0;"><span style="text-decoration: underline;">Captcha</span> + COI/DOI --&gt;  avoid <a href="https://www.spamhaus.org/news/article/734/subscription-bombing-coi-captcha-and-the-next-generation-of-mail-bombs" shape="rect" target="_blank"><span style="color: #c0c0c0;"><strong>Subscription Bombing</strong></span></a></span></div><div><strong> </strong></div><div><span style="color: #c0c0c0;"><strong>Until Spamhaus started listing ESPs, no one knew it (=subscription abuse) was happening. This includes the ESP that sent 81,000 confirmation emails to 9 email addresses over the course of 2 weeks.  <a href="https://wordtothewise.com/2016/09/ongoing-subscription-form-abuse/%5D" shape="rect" target="_blank"><span style="color: #c0c0c0;">https://wordtothewise.com/2016/09/ongoing-subscription-form-abuse/</span></a></strong></span></div><div><strong> </strong></div><div><br clear="none"/></div><div style="margin: 1em 0px; padding: 0px; border: 0px; outline: 0px; font-size: 16px; vertical-align: baseline; background-color: #f9f9f9; font-family: 'Open Sans', Verdana, Arial, Helvetica, sans-serif; font-weight: normal; letter-spacing: normal; -webkit-font-smoothing: antialiased; font-style: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-position: initial initial; background-repeat: initial initial;"><div><span style="color: #c0c0c0;">Naturally, spam filters are responding to that by actually following every single link in your email, so they can get to the final destination domain and block it (<a href="http://www.barracudanetworks.com/ns/news_and_events/index.php?nid=158" shape="rect" style="margin: 0px; padding: 0px; border: 0px; font-size: 16px; vertical-align: baseline; background: transparent; text-decoration: none;" target="_blank"><span style="color: #c0c0c0;">Barracuda’s firewall just introduced this</span></a> feature).</span></div></div><div style="margin: 1em 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background-color: #f9f9f9; font-weight: normal; letter-spacing: normal; -webkit-font-smoothing: antialiased; font-style: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><span style="font-size: 16px;"><span style="font-family: 'Open Sans', Verdana, Arial, Helvetica, sans-serif;"><span style="color: #c0c0c0;">It’s neat when you think about it. Until you realize that when spam filters follow every link in your email, they will inevitably follow your <strong style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-size: 16px; vertical-align: baseline; background: transparent;">unsubscribe</strong>link too. We’ve had a few recent cases of people mysteriously getting unsubscribed from lists, and we think we know why.</span></span></span></div></div><div><span style="color: #c0c0c0;"><br clear="none"/></span></div><div><span style="color: #c0c0c0;"><br clear="none"/></span></div><div><ol style="box-sizing: border-box; margin: 0px 0px 0px 1.25rem; padding: 0px; list-style-position: outside; font-family: 'Open Sans', sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff;" type="a"><li style="box-sizing: border-box; margin: 0px 0px 0.37rem; padding: 0px; font-size: inherit;"><span style="color: #c0c0c0;">Discourage snowshoeing. Don’t allow the same person, device or IP to easily sign up for many accounts. They will try to circumvent your thresholds by trickling many low-intensity streams of spam in parallel. (<em style="box-sizing: border-box; font-style: italic;">Trivia: This spammer strategy is called snowshoeing because it spreads the weight of their campaigns across a larger surface area.</em></span></li></ol><div style="box-sizing: border-box; margin: 0px 0px 0.37rem; padding: 0px;"><div><br clear="none"/></div><div><span style="font-size: 16px;"><span style="font-family: 'Open Sans', sans-serif;"><span style="background-color: #ffffff;"><span style="color: #546c82;"> </span></span></span></span></div><div><span style="color: #339966;"><span style="font-family: 'Open Sans', sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; float: none; display: inline !important;">One efficient way to remove spam traps from your list is through list segmentation. Identify clean list segments that are free of any possible spam traps and separate them from the rest of your list. If an address has not opened any emails for over six months, it may be a spam trap and should be sent one last confirmation email. Clean list segments need not be sent a confirmation email.</span></span></div><div><span style="font-size: 16px;"><span style="font-family: 'Open Sans', sans-serif;"><span style="background-color: #ffffff;"><span style="color: #546c82;"> </span></span></span></span></div><div><p style="box-sizing: border-box; font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; margin: 0px 0px 10px; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff;"><span style="color: #c0c0c0;">5. Seek out the dead domains. Many times these are used as<a href="http://support.sendgrid.com/entries/22177753-Spam-Trapped" shape="rect" style="box-sizing: border-box; background: transparent; text-decoration: none; font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased;" target="_blank"><span style="color: #c0c0c0;"> spam traps</span></a> and sending to them will ruin a sender’s deliverability. Write a script or make a list of the domains you are sending to and do an mx lookup via the command line or a service like http://mxtoolbox.com to find defunct domains,  some of which may now be turned into spam traps.  </span></p><p style="box-sizing: border-box; font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; margin: 0pt 0px; color: #333333; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff;"><strong style="box-sizing: border-box; font-weight: bold;"><strong style="box-sizing: border-box; font-weight: bold;"> </strong></strong></p><div style="box-sizing: border-box; -webkit-font-smoothing: antialiased; margin: 0px 0px 10px; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff;"><div style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">6. Find email addresses that are commonly used as spam traps or used to determine if you are sending spam. This means all role addresses (abuse@, sales@, help@, etc.) as well as common spam trap names (junk@, test@, asdf@, spam@, etc.).</span></span></span></div><div style="font-weight: normal;"><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"> </span></span></span></div><div style="font-weight: normal;"><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"> </span></span></span></div><div style="font-weight: normal;"><span style="color: #339966;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">Spam traps: list segmentation + reconfirmation</span></span></span></div><div style="font-weight: normal;"><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"> </span></span></span></div><div style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">Honeypot:</span></span></span></div><ul style="font-weight: normal;"><li><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="background-color: #ffff00;">clash82/<span style="background-color: #00ff00;"><strong>CachedHttpBl</strong></span>: Cached http:BL PHP class: <a href="https://github.com/clash82/cachedHttpBl" shape="rect" style="background-color: #ffff00;" target="_blank"><span style="color: #c0c0c0;">https://github.com/clash82/cachedHttpBl</span></a></span></span></span></span></li><li><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="font-weight: normal;">thasmo/</span><strong>php.honeypot-blacklist</strong> at master: <a href="https://github.com/thasmo/php.honeypot-blacklist/tree/master" shape="rect" style="font-weight: normal;" target="_blank"><span style="color: #c0c0c0;">https://github.com/thasmo/php.honeypot-blacklist/tree/master</span></a></span></span></span></li><li style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">Signup | AbyssGuard: <a href="https://www.abyssguard.com/signup/" shape="rect" target="_blank"><span style="color: #c0c0c0;">https://www.abyssguard.com/signup/</span></a></span></span></span></li><li style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">Bad Behavior — WordPress Plugins: <a href="https://wordpress.org/plugins/bad-behavior/" shape="rect" target="_blank"><span style="color: #c0c0c0;">https://wordpress.org/plugins/bad-behavior/</span></a></span></span></span></li><li style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">ModSecurity: Open Source Web Application Firewall: <a href="https://www.modsecurity.org/" shape="rect" target="_blank"><span style="color: #c0c0c0;">https://www.modsecurity.org/</span></a></span></span></span></li></ul><div style="font-weight: normal;"><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"> </span></span></span></div><div style="font-weight: normal;"><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"> </span></span></span></div><div style="font-weight: normal;"><span style="color: #c0c0c0;"><strong><span style="font-size: 19px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">Preventing CSRF and XSRF Attacks (using nonce...etc) :</span></span></strong></span></div><div style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"> </span></span></span></div><div style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">Also, consider issuing a <a href="http://en.wikipedia.org/wiki/Cryptographic_nonce" rel="nofollow" shape="rect" target="_blank"><span style="color: #c0c0c0;">nonce</span></a> in a hidden field every time someone loads a form - this will make it a bit more difficult for someone to submit data without going through your form.</span></span></span></div><ul><li style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="background-color: #fffaa5; -evernote-highlight: true;"><span style="text-decoration: underline;"><strong>Stateful random nonces</strong></span>:</span> Generating a random nonce and then remembering it to validate later.This is the strategy used to defeat CSRF attacks, which sounds closer to what is being asked for here.</span></span></span></li><li style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><strong>Generating Nonce:</strong><br clear="none"/></span></span></span><div style="margin: 0px 0px 1em; padding: 5px; border: 0px; width: auto; max-height: 600px; overflow: auto; background-color: #eff0f1; display: block; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: #c0c0c0;"><code style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, sans-serif; background-color: #eff0f1;"><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">$factory </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">=</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;"> </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">new</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;"> </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">RandomLib</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">\Factory</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">;</span></code> <span style="font-size: 12px;"><span style="font-family: 'courier new', courier, monospace;">// <a href="https://github.com/paragonie/random_compat" shape="rect" target="_blank"><span style="color: #c0c0c0;">https://github.com/paragonie/random_compat</span></a></span></span><code style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, sans-serif; background-color: #eff0f1;"><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;"><br clear="none"/> $generator </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">=</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;"> $factory</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">-&gt;</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">getMediumStrengthGenerator</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">();</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;"><br clear="none"/> $_SESSION</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">[</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">'nonce'</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">]</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;"> </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">[]</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;"> </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">=</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;"> $generator</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">-&gt;</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">generate</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">(</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">32</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">);</span></code></span></div></li><li style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><strong>Validating Nonce:<br clear="none"/></strong></span></span></span><div style="margin: 0px 0px 1em; padding: 5px; border: 0px; font-size: 13px; width: auto; max-height: 600px; overflow: auto; font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, sans-serif; background-color: #eff0f1; display: block; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: #c0c0c0;"><code style="margin: 0px; padding: 0px; border: 0px; font-size: 13px; font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, sans-serif; background-color: #eff0f1;"><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">$found </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">=</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;"> array_search</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">(</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">$nonce</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">,</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;"> $_SESSION</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">[</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">'nonces'</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">]);</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">if</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;"> </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">(!</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">$found</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">)</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;"> </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">{</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;"><br clear="none"/>    </span> <span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">throw</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;"> </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">new</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;"> </span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">Exception</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">(</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">&quot;Nonce not found! Handle this or the app crashes&quot;</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">);</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">}</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">// Yay, now delete it.</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;"><br clear="none"/> unset</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">(</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">$_SESSION</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">[</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">'nonce'</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">][</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">$found</span><span style="margin: 0px; padding: 0px; border: 0px; font-size: 13px;">]);</span></code></span></div></li><li style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif; font-size: 13px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; float: none; display: inline !important;">why would you want to secure your nonce with cryptographic strength? What is not enough with just using one-time nonces, created with a default hashing function (sha1, for example) with a pepper? Nonces are just for preventing CSRF, not for securing your complete application (you should just use HTTPS for that).<br clear="none"/></span> <span style="font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif; font-size: 13px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; float: none; display: inline !important;">I did not say, that the code posted above is secure, i just said that I think, that the following is enough: create a nonce using something like this: </span><code style="margin: 0px; padding: 1px 5px; border: 0px; font-size: 13px; font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, sans-serif; background-color: #eff0f1; white-space: normal; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">$nonce = hash(&quot;sha256&quot;, uniqid(PRETTY_LONG_SALT, true));</code></span><span style="color: #242729; font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif; font-size: 13px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; display: inline !important; float: none;"><span style="color: #c0c0c0;">. Store this nonce in the session (not a cookie), and send it to the form of the user. Also (if necessary) secure transportation using HTTPS. The user now needs to send the nonce with the next request (where it is checked). With it's response, a new one-time nonce is created. No need for cryptographically secure nonces, this is already enough.</span><br clear="none"/></span><span style="font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;"><span style="background-color: #ffffff;"><span style="color: #242729;"><br clear="none"/></span></span></span></li><li style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;"><span style="background-color: #ffffff;">The name of the XSS game is sanitizing user input. If you stick to a whitelist based approach -- only allow input that you know to be good, and immediately discard anything else -- then you're usually well on your way to solving any XSS problems you might have.<br clear="none"/><strong>So what can we do to protect our websites from these kinds of cross site request forgeries?</strong><br clear="none"/></span></span><a href="https://blog.codinghorror.com/cross-site-request-forgeries-and-you/" shape="rect" target="_blank"><span style="color: #c0c0c0;">https://blog.codinghorror.com/cross-site-request-forgeries-and-you/</span></a>:</span><ul><li style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;"><span style="background-color: #ffffff;"><strong>Check the referrer</strong>. The HTTP referrer, or HTTP &quot;referer&quot; as it is now permanently misspelled, should always come from your own domain. You could reject any form posts from alien referrers. However, this is risky, as some corporate proxies strip the referrer from all HTTP requests as an anonymization feature. You would end up potentially blocking legitimate users. Furthermore, spoofing the referrer value is extremely easy. <strong>All in all, a waste of time. Don't even bother with referrer checks.</strong></span></span></span></li><li style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;"><span style="background-color: #ffffff;"><strong>Secret hidden form value</strong>. Send down a unique server form value with each form -- typically tied to the user session -- and validate that you get the same value back in the form post. The attacker can't simply scrape your remote form as the target user through JavaScript, thanks to same-domain request limits in the XmlHttpRequest function.</span></span></span></li><li style="font-weight: normal;"><span style="font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;"><span style="background-color: #ffffff;"><span style="color: #242729;"><span style="color: #c0c0c0;"><strong>Double submitted cookies</strong>. It's sort of ironic, but another way to prevent XSRF, essentially a cookie-based exploit, is to add more cookies! Double submitting means sending the cookie both ways in every form request: first as a traditional header value, and again as a form value -- read via JavaScript and inserted. The trick here is that remote XmlHttpRequest calls can't read cookies. If either of the values don't match, discard the input as spoofed. The only downside to this approach is that it does require your users to have JavaScript enabled, otherwise their own form submissions will be rejected.<br clear="none"/></span><br clear="none"/></span></span></span></li></ul></li><li style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;"><span style="background-color: #ffffff;">True XSRF Prevention requires three parts (</span></span><a href="http://j.mp/2dCUZdV" shape="rect" target="_blank"><span style="color: #c0c0c0;">http://j.mp/2dCUZdV</span></a><span style="font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;"><span style="background-color: #ffffff;">):<br clear="none"/></span></span><code style="margin: 0px; padding: 1px 5px; border: 0px; font-size: 13px; font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, sans-serif; background-color: #eff0f1; white-space: normal; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">&lt;input id=&quot;fkey&quot; name=&quot;fkey&quot; type=&quot;hidden&quot; value=&quot;df8652852f139&quot; /&gt;</code></span><ul><li style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;"><span style="background-color: #ffffff;">Hidden Input Fields, to prevent someone from just snatching the form and embedding it</span></span></span></li><li style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;"><span style="background-color: #ffffff;">Timechecking within an epsilon of the form being generated, otherwise someone can generate a valid form once and use the token (depending on impementation/how it's stored)</span></span></span></li><li style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;"><span style="background-color: #ffffff;">Cookies: this is to prevent a malicious server from pretending it's a client, and performing a man-in-the-middle attack<br clear="none"/></span></span></span></li></ul></li><li style="font-weight: normal;"><p style="margin: 1.6em 0px; font-family: 'Open Sans', sans-serif; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: #c0c0c0;"><span style="background-color: #fffaa5; -evernote-highlight: true;">An even stronger, albeit more complex, prevention method is to leverage server state -- <strong style="font-weight: bold;">to generate (and track, with timeout) a unique random key for every single HTML FORM you send down to the client.</strong> We use a variant of this method on Stack Overflow with great success. That's why with every &lt;form&gt; you'll see the following:</span></span></p><div style="box-sizing: border-box; margin: 1.6em 0px; border: 1px solid #e3edf3; width: 634.406px; padding: 10px; overflow: auto; background-color: #f7fafb; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-position: initial initial; background-repeat: initial initial;"><span style="color: #c0c0c0;"><span style="font-family: Inconsolata, monospace, sans-serif;"><span style="background-color: #fffaa5; -evernote-highlight: true;"><span style="font-family: Consolas;">&lt;input id=&quot;fkey&quot; name=&quot;fkey&quot; type=&quot;hidden&quot; value=&quot;df8652852f139&quot; /&gt;</span></span></span></span></div></li></ul><div style="font-weight: normal;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="color: #333333;"> </span></span></span></div><div style="font-weight: normal;"><span style="color: #c0c0c0;"> </span></div><div style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14pt;"><strong>MailChimp's Subscription Form (hidden fields use):</strong></span></span></div><div style="font-weight: normal;"><span style="color: #c0c0c0;"> </span></div><div style="font-weight: normal;"><span style="color: #c0c0c0;">Link: <a href="https://morrisonpitt.us2.list-manage.com/subscribe?u=dd538c1f8f70af0f1471357bc&amp;id=484358390d" shape="rect" target="_blank"><span style="color: #c0c0c0;">https://morrisonpitt.us2.list-manage.com/subscribe?u=dd538c1f8f70af0f1471357bc&amp;id=484358390d</span></a> </span></div></div></div><ul><li style="font-weight: normal;"><div style="box-sizing: border-box; margin: 1.6em 0px; border: 1px solid #e3edf3; width: 634.406px; padding: 10px; overflow: auto; background-color: #f7fafb; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-position: initial initial; background-repeat: initial initial;"><span style="color: #c0c0c0;">&lt;form action=&quot;https://jsplumbtoolkit.us2.list-manage.com/subscribe/post&quot; method=&quot;POST&quot;&gt;<br clear="none"/> &lt;input type=&quot;hidden&quot; name=&quot;u&quot; value=&quot;dd538c1f8f70af0f1471357bc&quot;&gt;<br clear="none"/> &lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;484358390d&quot;&gt;<br clear="none"/><br clear="none"/><span style="background-color: #00ff00;">&lt;!-- people should not fill these in and expect good things --&gt;<br clear="none"/></span><br clear="none"/><span style="background-color: #99ccff;">&lt;div class=&quot;field-shift&quot; aria-label=&quot;Please leave the following three fields empty&quot;&gt;<br clear="none"/></span><br clear="none"/>     <span style="background-color: #00ccff;">&lt;label for=&quot;b_name&quot;&gt;Name: &lt;/label&gt;<br clear="none"/></span><br clear="none"/>     <span style="background-color: #00ccff;">&lt;input type=&quot;text&quot; name=&quot;b_name&quot; tabindex=&quot;-1&quot; value=&quot;&quot; placeholder=&quot;Freddie&quot; id=&quot;b_name&quot;&gt;</span><br clear="none"/><br clear="none"/>     <span style="background-color: #00ccff;">&lt;label for=&quot;b_email&quot;&gt;Email: &lt;/label&gt;<br clear="none"/></span><br clear="none"/>     <span style="background-color: #00ccff;">&lt;input type=&quot;email&quot; name=&quot;b_email&quot; tabindex=&quot;-1&quot; value=&quot;&quot; placeholder=&quot;youremail@gmail.com&quot; id=&quot;b_email&quot;&gt;</span><br clear="none"/><br clear="none"/>     <span style="background-color: #00ccff;">&lt;label for=&quot;b_comment&quot;&gt;Comment: &lt;/label&gt;<br clear="none"/></span><br clear="none"/>     <span style="background-color: #00ccff;">&lt;textarea name=&quot;b_comment&quot; tabindex=&quot;-1&quot; placeholder=&quot;Please comment&quot; id=&quot;b_comment&quot;&gt;&lt;/textarea&gt;<br clear="none"/></span><br clear="none"/><span style="background-color: #99ccff;">&lt;/div&gt;<br clear="none"/></span><br clear="none"/> &lt;div id=&quot;mergeTable&quot; class=&quot;mergeTable&quot;&gt;<br clear="none"/> &lt;div class=&quot;mergeRow dojoDndItem mergeRow-email&quot; id=&quot;mergeRow-0&quot;&gt;<br clear="none"/> &lt;label for=&quot;MERGE0&quot;&gt;Email Address &lt;span class=&quot;req asterisk&quot;&gt;*&lt;/span&gt;&lt;/label&gt;<br clear="none"/> &lt;div class=&quot;field-group&quot;&gt;<br clear="none"/> &lt;input type=&quot;email&quot; autocapitalize=&quot;off&quot; autocorrect=&quot;off&quot; name=&quot;MERGE0&quot; id=&quot;MERGE0&quot; size=&quot;25&quot; value=&quot;&quot;&gt;<br clear="none"/> &lt;/div&gt;<br clear="none"/> &lt;/div&gt;<br clear="none"/> &lt;/div&gt;<br clear="none"/> &lt;!-- ...code... --&gt;<br clear="none"/> &lt;/form&gt;</span></div></li></ul><div style="box-sizing: border-box; -webkit-font-smoothing: antialiased; margin: 0px 0px 10px; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff;"><div style="font-weight: normal;"><span style="color: #c0c0c0;"> </span></div><div style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><strong>Maximize query/IP:</strong> It works well to prevent sending many messages, but a few copies of them will still get in. If you think that's affordable, this might work. Note: a spammer can use proxies or dinamic IP, but that might be slow. Perhaps consider not blocking the user but adding a captcha if they send too many e-mails.</span></span></span></div><div style="font-weight: normal;"><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"> </span></span></span></div><div style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><a href="https://github.com/mccarthy/phpFormProtect" shape="rect" target="_blank"><span style="color: #c0c0c0;">https://github.com/mccarthy/phpFormProtect</span></a>:</span></span></span></div><div style="font-weight: normal;"><ul><li><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><strong>Hidden Form Field</strong> - If hidden form field is filled in, this is an indicator of spam</span></span></span></li><li><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><strong>Time Form Submission</strong> - If form is filled out too fast or too slow, this is an indicator of spam</span></span></span></li><li><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="text-decoration: line-through;">Too many URLs - If the comment field has too many URLs (Number is configurable) this is an indicator of spam</span></span></span></span></li><li><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="text-decoration: line-through;">Mouse Movement - If the user does not use their mouse, this is an indicator of spam</span></span></span></span></li><li><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="text-decoration: line-through;">Used Keyboard - If the user does not use their keybaord, this is an indicator of spam</span></span></span></span></li><li><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><strong>Validate Referer</strong> - If the HTTP referer does not match the form URL, we shouldn't accept the submission.</span></span></span></li><li><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><strong>Validate Email</strong> - If the email address provided in the form is not valid from a syntax perspective, we shouldn't accept the submission.</span></span></span></li></ul></div><div style="font-weight: normal;"><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"> </span></span></span></div><div style="font-weight: normal;"><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"> </span></span></span></div><div style="font-weight: normal;"><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"> </span></span></span></div><div style="font-weight: normal;"><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"> </span></span></span></div><div><p style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">You can protect your form with the <strong>form keys</strong> technique:</span></span></span></p><ol style="font-weight: normal;"><li><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">When displaying the form to the user, generate a random ID (&quot;form key&quot;) just for this single form submission. Store the form key in a session variable. Submit the &quot;form key&quot; in a hidden input field.</span></span></span></li><li><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">On the submit side, check the submitted form key against the one stored in the session variable. Immediately invalidate it after use. (delete it from the session)</span></span></span></li></ol><p style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><strong>Without a captcha or something comparable, it is impossible to <em>really</em> protect a form from abuse.</strong></span></span></span></p><p style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">However, using this technique a malicious spammer would have to</span></span></span></p><ol style="font-weight: normal;"><li><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">request for form via HTTP for each single form submission to obtain a valid unique forkey</span></span></span></li><li><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">parse the DOM tree / HTML code to obtain the form key</span></span></span></li><li><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">submit it in the correct format</span></span></span></li></ol><div style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">No automatic spamming contact form crawler does that, as far as i know.</span></span></span></div></div><div style="font-weight: normal;"><br clear="none"/></div><div style="font-weight: normal;"><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"> </span></span></span></div><div><p style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">You can implement a <strong>time limit</strong> from an IP. So if a spam bot tries to send the form again and again (in a specific time interval, say 1 hour), the request should be rejected.</span></span></span></p><p style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">You'll have to do this on the Server-Side by checking and storing the IPs of the users. Then when they again send the form, check if the user is already in the blocked IPs for the time being.</span></span></span></p><p style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"> </span></span></span></p><p style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">Most large ISPs only use the most reputable blacklists like  <a href="https://www.spamcop.net/" shape="rect" target="_blank" title="SpamCop"><span style="color: #c0c0c0;">SpamCop</span></a>, <a href="http://www.spamhaus.org/" shape="rect" target="_blank" title="Spamhaus"><span style="color: #c0c0c0;">Spamhaus</span></a> and <a href="http://uribl.com/about.shtml#info" shape="rect" target="_blank" title="URIBL"><span style="color: #c0c0c0;">URIBL</span></a>.</span></span></span></p></div><div><br clear="none"/></div><div style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="font-size: 14pt;">Check subscription form HTML source code of reputable web sites:</span></span></span></span></div><div><span style="color: #c0c0c0;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><br clear="none"/></span></span></div><ul style="font-weight: normal;"><li><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><strong>Code: <a href="https://gist.github.com/amindeed/02df1050e3ec849d7df85b30f631ba3d" shape="rect" target="_blank"><span style="color: #c0c0c0;">https://gist.github.com/amindeed/02df1050e3ec849d7df85b30f631ba3d<br clear="none"/></span></a>Source Page: </strong></span></span></span> <span style="color: #333333; font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif; font-size: 14px;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><a href="https://blog.mailerlite.com/growing-your-list-with-facebook-lead-ads-and-zapier/" shape="rect" target="_blank"><span style="color: #c0c0c0;">https://blog.mailerlite.com/growing-your-list-with-facebook-lead-ads-and-zapier/</span></a><span style="color: #c0c0c0;"> <br clear="none"/><br clear="none"/></span></span></span></span></li><li><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="color: #c0c0c0;">You could do what Google does. Which is after a certain number of trys they have a captacha show up. Than after a couple of times with the captacha you lock them out for a couple of minutes.</span></span></span></span></li></ul><div><br clear="none"/></div><div><p style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="font-size: 14pt;">Prevent Brute Forcing:</span></span></span></span></p><ul><li style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">Try adding two fields to your user table, 'first_failed_login' [<code><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">INTEGER</span></code> unix timestamp or <code><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">DATETIME</span></code>] and 'failed_login_count'. [<code><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">INTEGER</span></code>]. This will make your login system recognize only 3 login attempts per user every 10 minutes.<br clear="none"/><strong>Code:</strong> <a href="https://gist.github.com/amindeed/d0fc81e552be64ff5685145ebc15e028" shape="rect" target="_blank"><span style="color: #c0c0c0;">https://gist.github.com/amindeed/d0fc81e552be64ff5685145ebc15e028</span></a> <br clear="none"/><br clear="none"/></span></span></span></li><li style="font-weight: normal;"><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="color: #c0c0c0;">Do not rely on sessions or cookies, those trust the client and you should NEVER trust the client. I made a class that takes care of brute force attack protection in PHP.<br clear="none"/><strong>Code: </strong><a href="https://github.com/ejfrancis/brute-force-block#usage" shape="rect" target="_blank"><span style="color: #c0c0c0;">https://github.com/ejfrancis/brute-force-block#usage</span></a> <br clear="none"/></span><br clear="none"/></span></span></span></li><li style="font-weight: normal;"><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="color: #c0c0c0;">The consensus was that you can make an SQL table of failed attempts along with timestamps for each one. Then you would query that on a failed login and check the number of attempts and timestamps using cookies or querying every time.</span><br clear="none"/><br clear="none"/></span></span></span></li><li><p style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">I tend to agree with most of the other comments:</span></span></span></p><ul><li><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="background-color: #ffff99;">Lock after X failed password attempts <strong>(Check next bullet point)</strong></span></span></span></span></li><li style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">Count failed attempts against username</span></span></span></li><li style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">Optionally use CAPTCHA (for example, attempts 1-2 are normal, attempts 3-5 are CAPTCHA'd, further attempts blocked for 15 minutes).</span></span></span></li><li style="font-weight: normal;"><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="color: #c0c0c0;">Optionally send an e-mail to the account owner to remove the block</span><br clear="none"/><br clear="none"/><br clear="none"/></span></span></span></li></ul></li><li style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="background-color: #ffff99;">Increasing delay with a fixed upper bound, like:</span></span></span></span><ul><li><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="background-color: #ffff99;">1 failed attempt = 5 sec delay</span></span></span></span></li><li><span style="color: #c0c0c0;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="background-color: #ffff99;">2 failed attempts = 15 sec delay</span></span></span></span></li><li><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="color: #c0c0c0;"><span style="background-color: #ffff99;">3+ failed attempts = 45 sec delay</span></span><br clear="none"/><br clear="none"/><span style="color: #c0c0c0;"><span style="background-color: #ffff99;">The delay is <em>not</em> a delay before returning the response to the browser. It is more like a timeout or refractory period during which login attempts to a specific account or from a specific IP address will not be accepted or evaluated at all. That is, correct credentials will not return in a successful login, and incorrect credentials will not trigger a delay increase.</span></span><br clear="none"/><br clear="none"/><span style="background-color: #ffff99;"><span style="color: #c0c0c0;">DoS attacking this final login throttling scheme would be <strong><em>very</em></strong> impractical. And as a final touch, always allow persistent (cookie) logins (and/or a CAPTCHA-verified login form) to pass through, so legitimate users won't even be delayed <em>while the attack is in progress</em>. That way, the very impractical DoS attack becomes an <em>extremely</em> impractical attack.<br clear="none"/></span><br clear="none"/><span style="color: #c0c0c0;">If a user tries to log in (ie. posts login credentials to the server) they will not be checked and an error is returned. A server-synchronized countdown clock should be displayed next to the login form to inform the user of the throttling. The form itself or the submit button should be disabled until the countdown is done.</span></span></span></span></span></li></ul></li></ul></div><ul style="font-weight: normal;"><li><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"> </span></span></span></li><li><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="color: #c0c0c0;">common mistake of serving login forms over HTTP. I've even argued with people who said &quot;but it submits to https://...&quot; and only got blank stares when I asked if they were sure an attacker didn't rewrite the non-encrypted page the form was served over.</span><br clear="none"/><br clear="none"/></span></span></span></li><li><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="color: #c0c0c0;">The super-useful <code><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">HttpOnly</span></code> cookie flag, which prevents JavaScript-based cookie theft (a subset of XSS attacks)<br clear="none"/></span><br clear="none"/></span></span></span></li><li><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="color: #c0c0c0;">If at all possible, make sure the session cookie has the secure and HTTP Only flags set when sent to the browser. The httponly flag provides some protection against the cookie being read by a XSS attack. The secure flag ensures that the cookie is only sent back via HTTPS, and therefore protects against network sniffing attacks. The value of the cookie should not be predictable. Where a cookie referencing a non-existent session is presented, its value should be replaced immediately to prevent <a href="https://www.owasp.org/index.php/Session_fixation" shape="rect" target="_blank"><span style="color: #c0c0c0;">session fixation</span></a>.<br clear="none"/></span><br clear="none"/></span></span></span></li><li><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="color: #339966;"><span style="text-decoration: underline;"><strong>Counter note about session cookies</strong></span>: You can (and should, for stateless servers!) use a cryptographically signed cookie. That's impossible to forge, doesn't tie up server resources, and doesn't need sticky sessions or other shenanigans<br clear="none"/></span><br clear="none"/></span></span></span></li><li><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="color: #c0c0c0;"><strong>Best Distributed Brute Force countermeasure?</strong> the best practice would be <strong>logging the number of failed logins, system-wide</strong>, and using a running average of your site's bad-login frequency as the basis for an upper limit that you then impose on all users.</span> <em><strong><span style="color: #c0c0c0;">(PART VII: Distributed Brute Force Attacks - <a href="http://stackoverflow.com/a/477578/3208373" shape="rect" target="_blank"><span style="color: #c0c0c0;">http://stackoverflow.com/a/477578/3208373</span></a>)<br clear="none"/></span><br clear="none"/></strong></em></span></span></span></li><li><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="color: #339966;"><span style="text-decoration: underline;"><strong>Q:</strong></span> For persistent login. How is the Username+token better than just a random session-id that the server has mapped to the username and loginstatus? I have never even heard of the first method before.<br clear="none"/><strong><span style="text-decoration: underline;">A:</span></strong> By including the username in the persistent login cookie token, you avoid a scenario where an attacker has 10 million chances to guess a correct token (on a site with 10 million users). Of course, if the token string is long enough, it shouldn't be a big issue, but I would still recommend it.<br clear="none"/><br clear="none"/></span></span></span></span></li><li><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="color: #339966;"><span style="text-decoration: underline;"><strong>Q:</strong></span> How is a second cookie for persistent login better than one cookie/session with a longer expiration time? <br clear="none"/><span style="text-decoration: underline;"><strong>A:</strong></span> Session cookies are transient by definition, ie. they automatically expire when the user closes the browser window.<br clear="none"/><span style="text-decoration: underline;"><strong>Q:</strong></span> Why? If the purpose of the cookie is to store information about the login session, why wouldn't it last as long as the login is going to last? It seems like have separate session/remember-me cookies just adds complexity.<br clear="none"/><span style="text-decoration: underline;"><strong>A:</strong></span> You are not talking about a session cookie then. Session cookies by definition have no expires directive. If you add an expires directive to a session cookie, it becomes a persistent cookie. It sounds like you want to make your &quot;session&quot; cookie persistent and eliminate the true session-limited cookie. I guess that's possible, but you lose all the useful things you can do with session cookies, i.e. keeping transient lightweight state objects in memory (you don't want to keep all session data alive for months, trust me).<br clear="none"/> The token is just a random generated value. Save the user ID and token in the cookie, then save a hash of the token in the DB. that way, you can validate the login cookie by re-hashing the token and checking the user record for a match.<br clear="none"/></span><br clear="none"/><br clear="none"/><span style="color: #339966;"><br clear="none"/></span></span></span></span></li><li><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="color: #339966;"><span style="text-decoration: underline;"><strong>Q:</strong></span> Great answer, thanks. Can you explain why the 'Improved' Best Practices for persistent login is flawed? At first blush it does seem like it addresses the DOS scenario for invalidating sessions with Miller's approach, what am I missing?<br clear="none"/><span style="text-decoration: underline;"><strong>A:</strong></span> When the user re-logs-in, nothing is deleted, since the safety deletion only occurs if the site is passed an old cookie containing a valid series identifier and an invalid token. Since there is no such cookie (because the attacker deleted it), the system simply initiates a new series and doesn't even warn the user. (remember: a user can have many laptops = many series identifiers, and the 'improved' system can't tell the difference).<br clear="none"/> Absolutely correct - I didn't mean to portray it as a drawback, my only point is that the 'improvement' doesn't actually deliver on its promise. It can make implementors and site owners believe their auth system protects against cookie stealing, and it doesn't -- and fake security is worse than no security.<br clear="none"/></span><br clear="none"/><br clear="none"/></span></span></span></li><li><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="color: #339966;">Security must be everywhere: sanatizing user inputs, using prepared statements for sql, making sure that resources arent url predictable, then there is the whole XSS set of issues...<br clear="none"/><br clear="none"/><br clear="none"/></span></span></span></span></li><li><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><span style="color: #339966;">More about cookies/session security:<br clear="none"/><a href="https://stackoverflow.com/questions/549/the-definitive-guide-to-form-based-website-authentication?noredirect=1&amp;lq=1#comment24173715_477578" shape="rect" target="_blank"><span style="color: #339966;">https://stackoverflow.com/questions/549/the-definitive-guide-to-form-based-website-authentication?noredirect=1&amp;lq=1#comment24173715_477578</span></a> <br clear="none"/></span><br clear="none"/></span></span></span></li><li><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><a href="http://en.wikipedia.org/wiki/Session_hijacking" shape="rect" target="_blank"><span style="color: #339966;">Cookies can be hijacked</span></a><span style="color: #339966;">: they are only as secure as the rest of the client's machine and other communications. They can be read from disk, sniffed in network traffic, lifted by a cross-site scripting attack, phished from a poisoned DNS so the client sends their cookies to the wrong servers. Don't send persistent cookies. Cookies should expire at the end of the client session (browser close or leaving your domain).<br clear="none"/> If you want to autologin your users, you can set a persistent cookie, but it should be distinct from a full-session cookie. You can set an additional flag that the user has auto-logged in, and needs to login for real for sensitive operations. This is popular with shopping sites..<br clear="none"/></span><br clear="none"/></span></span></span></li><li><span style="color: #666666; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; display: inline !important; float: none;"><span style="color: #c0c0c0;">When these forms are submitted, the content will be discarded while still returning a <span style="background-color: #fffaa5; -evernote-highlight: true;">200 response</span>.<br clear="none"/></span><br clear="none"/></span></li><li><span style="font-size: 14px;"><span style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';"><span style="background-color: #ffffff;"><span style="color: #666666;"><span style="color: #c0c0c0;"> <strong>Serious Form Security | CSS-Tricks</strong>: <a href="https://css-tricks.com/serious-form-security/" shape="rect" target="_blank"><span style="color: #c0c0c0;">https://css-tricks.com/serious-form-security/</span></a> <br clear="none"/></span></span></span></span></span><span style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';"><span style="background-color: #ffffff;"><span style="color: #666666;"><br clear="none"/></span></span></span></li><li><span style="color: #c0c0c0;"><strong>jQuery response after submit:</strong> <a href="http://tutorialzine.com/2013/08/simple-registration-system-php-mysql/" shape="rect" style="font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" target="_blank"><span style="color: #c0c0c0;">http://tutorialzine.com/2013/08/simple-registration-system-php-mysql/</span></a></span></li></ul><div><br clear="none"/></div><div style="font-weight: normal;"><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"><em><strong> </strong></em></span></span></span></div><div style="font-weight: normal;"><span style="color: #c0c0c0;"><span style="font-size: 24px;"><strong><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;">Fallback mode (when Javascript is disabled)</span></strong></span></span></div><div><span style="color: #c0c0c0;"><br clear="none"/></span></div><div style="font-weight: normal;"><ul style="font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff;"><li><span style="color: #c0c0c0;"><strong>**Premium**: </strong><a href="https://dcrazed.com/best-php-ajax-contact-forms/" shape="rect" target="_blank"><span style="color: #c0c0c0;">https://dcrazed.com/best-php-ajax-contact-forms/</span></a></span><ul><li><a href="http://preview.codecanyon.net/item/flora-forms-responsive-ajax-contact-forms/full_screen_preview/10707361?ref=hdalive" shape="rect" target="_blank"><span style="color: #c0c0c0;">http://preview.codecanyon.net/item/flora-forms-responsive-ajax-contact-forms/full_screen_preview/10707361?ref=hdalive</span></a><br clear="none"/><ul><li><a href="http://doptiq.com/floraform/demos/forms/upds/green/" shape="rect" target="_blank"><span style="color: #c0c0c0;">http://doptiq.com/floraform/demos/forms/upds/green/</span></a><br clear="none"/></li></ul></li></ul></li><li><a href="http://bootstrapious.com/p/how-to-build-a-working-bootstrap-contact-form?utm_source=sendy&amp;utm_medium=email&amp;utm_campaign=drip2" shape="rect" target="_blank"><span style="color: #c0c0c0;">http://bootstrapious.com/p/how-to-build-a-working-bootstrap-contact-form?utm_source=sendy&amp;utm_medium=email&amp;utm_campaign=drip2</span></a></li></ul></div><div><span style="color: #333333;"><span style="font-size: 14px;"><span style="font-family: 'Proxima N W15 Reg', Helvetica, Arial, sans-serif;"> </span></span></span></div></div></div></div><hr/><div><br clear="none"/></div><div><span style="font-size: 19px;">Advices:</span></div><div><br clear="none"/></div><div><br clear="none"/></div><div>About Subscriber Engagement | MailChimp.com: KB Article  <a href="http://kb.mailchimp.com/lists/growth/about-subscriber-engagement" shape="rect" target="_blank">http://kb.mailchimp.com/lists/growth/about-subscriber-engagement</a></div><div><br clear="none"/></div><div><h3>Maintain Permission</h3><p>Permission goes stale if you don't actively send to, and engage with, your subscribers. If you have subscribers who haven't been sent to regularly, we recommend you reconfirm the addresses outside of MailChimp to reduce bounces and abuse complaints.</p><p>It's also a good idea to include a permission reminder in each campaign you send. This briefly reminds your subscriber how they got on your list, and why they’re receiving emails from you.</p></div><div><br clear="none"/></div><div><br clear="none"/></div><div>Periodically re-engage inactive subscribers to confirm their interest in your business or product. If your inactive subscribers don't respond to your re-engagement campaign, it's best to remove them from your list.</div><div><br clear="none"/></div><div><br clear="none"/></div><div><h3>Use a Master List</h3><p>MailChimp treats all the lists in your account separately, and your Monthly Plan billing is based on your total subscriber count across all your lists. It can be more costly to maintain multiple lists, and you may run into compliance issues if bounced addresses are removed from one list in your account, but still exist in the subscribed section of another.</p><p>If you have duplicate subscribers across different lists, consider combining your lists into a master list and using groups to organize your subscribers. This can simplify your list management, and may reduce the cost of your monthly bill.</p><p><a href="http://kb.mailchimp.com/lists/growth/ways-to-combine-lists-in-mailchimp" shape="rect" target="_blank">Ways to Combine Lists in MailChimp</a></p><h3>Include an Update Profile Link in Campaigns</h3><p>An update profile link allows your recipients to update their subscription preferences, sort themselves into interest <a href="http://kb.mailchimp.com/lists/groups/add-groups-to-a-list" shape="rect" target="_blank">groups</a>, and make any other subscription changes they want. You might find that subscribers choose to change groups, rather than unsubscribe from your list entirely.</p><p><a href="http://kb.mailchimp.com/campaigns/design/add-an-update-profile-link" shape="rect" target="_blank">Add an Update Profile Link</a></p></div><div><br clear="none"/></div><div><br clear="none"/></div><div><strong>Mobile Friendly Newsletters</strong> | MailerLite: <a href="https://www.mailerlite.com/mobile-newsletters" shape="rect" target="_blank">https://www.mailerlite.com/mobile-newsletters</a></div><div><br clear="none"/></div><div><br clear="none"/></div><div><strong>4 Tactics I’ve Used to Get 2,095 Email Subscribers From Scratch</strong> – Email Marketing Blog by MailerLite: <a href="https://blog.mailerlite.com/4-tactics-ive-used-to-get-2095-email-subscribers-from-scratch/" shape="rect" target="_blank">https://blog.mailerlite.com/4-tactics-ive-used-to-get-2095-email-subscribers-from-scratch/</a> </div><div><br clear="none"/></div><div><br clear="none"/></div><div><strong>Growing your list with Facebook Lead Ads and Zapier</strong> – Email Marketing Blog by MailerLite: <a href="https://blog.mailerlite.com/growing-your-list-with-facebook-lead-ads-and-zapier/" shape="rect" target="_blank">https://blog.mailerlite.com/growing-your-list-with-facebook-lead-ads-and-zapier/</a> <br clear="none"/><br clear="none"/></div><div><br clear="none"/></div><div><strong>security-guide-for-developers/security-checklist.md at master · FallibleInc/security-guide-for-</strong><strong>developers:</strong> <a href="https://github.com/FallibleInc/security-guide-for-developers/blob/master/security-checklist.md" shape="rect" target="_blank">https://github.com/FallibleInc/security-guide-for-developers/blob/master/security-checklist.md</a>  </div><div><br clear="none"/></div><div><br clear="none"/></div><div>Lockout and throttling policy is great, but using a <em>password</em> digest like bcrypt or scrypt instead of a general purpose hashing function enforces this at the lowest level possible. There is no way around having to put in the full amount of work to generate a password digest, so no developer can simply forget to implement or accidentally disable the throttling mechanism</div><div><br clear="none"/></div><div>Given the recent MITM vulnerability surrounding signed SSL certificates (<a href="https://blog.startcom.org/?p=145" rel="nofollow" shape="rect" target="_blank">blog.startcom.org/?p=145</a>) so a combination of SSL and some kind of Challenge response authentication (There are alternatives to SRP) is probably a better solution. – <a href="https://stackoverflow.com/users/13834/kevin-loney" shape="rect" target="_blank" title="5,367 reputation">Kevin Loney</a> <span dir="ltr"><a href="https://stackoverflow.com/questions/549/the-definitive-guide-to-form-based-website-authentication?noredirect=1&amp;lq=1#comment278816_555" shape="rect" target="_blank"><span title="2009-01-20 00:20:23Z">Jan 20 '09 at 0:20</span></a></span></div><div><br clear="none"/></div><div><br clear="none"/></div><div><span style="color: #242729; font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; display: inline !important; float: none;">pass at least the time variable in the session if not both, the time and the hash. Assuming that your <span style="background-color: #fffaa5; -evernote-highlight: true;">using server-side sessions and not cookie sessions</span> then they cannot be tampered with unless someone has access to the server, in which case your already screwed.</span></div><div><br clear="none"/></div><div><br clear="none"/></div><div><br clear="none"/></div><div><br clear="none"/></div></span>
</div></body></html> 